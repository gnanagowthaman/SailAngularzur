{"remainingRequest":"/home/vahai/Desktop/jun16/SailAngularzur/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js??ref--3-1!/home/vahai/Desktop/jun16/SailAngularzur/node_modules/@progress/kendo-angular-grid/dist/es/excel/excel.component.js","dependencies":[{"path":"/home/vahai/Desktop/jun16/SailAngularzur/node_modules/@progress/kendo-angular-grid/dist/es/excel/excel.component.js","mtime":1529128645667},{"path":"/home/vahai/Desktop/jun16/SailAngularzur/node_modules/cache-loader/dist/cjs.js","mtime":1529128679567},{"path":"/home/vahai/Desktop/jun16/SailAngularzur/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js","mtime":1519266497000}],"contextDependencies":[],"result":["import { Component, Input, ContentChildren, QueryList } from '@angular/core';\nimport { Observable } from 'rxjs/Observable';\nimport { take } from 'rxjs/operators/take';\nimport { saveAs } from '@progress/kendo-file-saver';\nimport { toDataURL, workbookOptions, ColumnBase } from '@progress/kendo-angular-excel-export';\nimport { ExcelService } from './excel.service';\nimport { ExcelExportEvent } from './excel-export-event';\nimport { LocalizationService } from '@progress/kendo-angular-l10n';\n/* tslint:disable object-literal-sort-keys */\nvar fetchComponentData = function (component) {\n    return {\n        data: component.view.map(function (item) { return item; }),\n        group: component.group\n    };\n};\n/**\n * Configures the Excel export settings of the Kendo UI Grid.\n *\n * For more information, refer to the article on\n * [exporting the Grid to Excel]({% slug excelexport_grid %}).\n */\nvar ExcelComponent = /*@__PURE__*/ (function () {\n    function ExcelComponent(excelService, localization) {\n        this.localization = localization;\n        /**\n         * Specifies the file name of the exported Excel file.\n         * @default \"Export.xlsx\"\n         */\n        this.fileName = 'Export.xlsx';\n        /**\n         * @hidden\n         */\n        this.columns = new QueryList();\n        this.saveSubscription = excelService.saveToExcel.subscribe(this.save.bind(this));\n    }\n    ExcelComponent.prototype.ngOnDestroy = function () {\n        this.saveSubscription.unsubscribe();\n        if (this.dataSubscription) {\n            this.dataSubscription.unsubscribe();\n        }\n    };\n    ExcelComponent.prototype.save = function (component) {\n        var _this = this;\n        var data = (this.fetchData || fetchComponentData)(component);\n        var exportData = function (result) {\n            delete _this.dataSubscription;\n            _this.exportData(component, result);\n        };\n        if (data instanceof Promise) {\n            data.then(exportData);\n        }\n        else if (data instanceof Observable) {\n            this.dataSubscription = data.pipe(take(1)).subscribe(exportData);\n        }\n        else {\n            exportData(data);\n        }\n    };\n    ExcelComponent.prototype.exportData = function (component, result) {\n        var options = workbookOptions({\n            columns: this.columns.length ? this.columns : component.columns,\n            data: result.data,\n            group: result.group,\n            filterable: this.filterable,\n            creator: this.creator,\n            date: this.date,\n            paddingCellOptions: this.paddingCellOptions,\n            headerPaddingCellOptions: this.headerPaddingCellOptions,\n            rtl: this.localization.rtl\n        });\n        var args = new ExcelExportEvent(options);\n        component.excelExport.emit(args);\n        if (!args.isDefaultPrevented()) {\n            this.saveFile(options);\n        }\n    };\n    ExcelComponent.prototype.saveFile = function (options) {\n        var _this = this;\n        toDataURL(options).then(function (dataURL) {\n            saveAs(dataURL, _this.fileName, {\n                forceProxy: _this.forceProxy,\n                proxyURL: _this.proxyURL\n            });\n        });\n    };\n    return ExcelComponent;\n}());\nexport { ExcelComponent };\n",null]}